<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>é–€å¸‚æ’ç­ç®¡ç†</title>
    <style>
        /* === å…¨å±€è®Šæ•¸å®šç¾© (ç¾ä»£é…è‰²æ–¹æ¡ˆ) === */
        :root {
            --bg-main: #f0f2f5;      /* èƒŒæ™¯ï¼šæ¥µæ·ºç°è— */
            --bg-card: #ffffff;      /* å¡ç‰‡ï¼šç´”ç™½ */
            --text-primary: #2c3e50; /* ä¸»è¦æ–‡å­—ï¼šæ·±è—ç° */
            --text-secondary: #95a5a6; /* æ¬¡è¦æ–‡å­—ï¼šæ·ºç° */
            
            /* å“ç‰Œè‰²ç³» */
            --color-brand: #3498db;  /* å“ç‰Œè— */
            --color-brand-light: #ebf5fb; 
            
            /* åŠŸèƒ½è‰² */
            --color-success: #2ecc71; /* ç¶ è‰² (ä¸Šç­) */
            --color-warning: #f1c40f; /* é»ƒè‰² (æ”¯æ´/æ³¨æ„) */
            --color-danger: #e74c3c;  /* ç´…è‰² (æ™šç­/åœ°é») */
            --color-rest: #bdc3c7;    /* ç°è‰² (ä¼‘å‡) */
            
            --shadow-card: 0 8px 20px rgba(0, 0, 0, 0.06);
            --shadow-float: 0 4px 12px rgba(52, 152, 219, 0.2);
            --radius-md: 16px;
            --radius-sm: 8px;
        }

        /* === å…¨å±€è¨­å®š === */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-main);
            color: var(--text-primary);
            padding: 0; margin: 0; padding-bottom: 100px;
            -webkit-font-smoothing: antialiased;
        }
        .container { max-width: 500px; margin: 0 auto; min-height: 100vh; }
        
        /* === é ‚éƒ¨å€åŸŸ (Glassmorphism) === */
        .sticky-header {
            position: sticky; top: 0; z-index: 100;
            padding: 15px 20px 10px 20px;
            background: rgba(240, 242, 245, 0.85); /* åŠé€æ˜èƒŒæ™¯ */
            backdrop-filter: blur(12px); /* æ¯›ç»ç’ƒæ•ˆæœ */
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255,255,255,0.3);
        }

        /* æ—¥æœŸæ§åˆ¶å¡ç‰‡ */
        .header-controls {
            display: flex; justify-content: space-between; align-items: center;
            background: var(--bg-card); padding: 8px 12px;
            border-radius: 50px; /* è† å›Šç‹€ */
            margin-bottom: 15px;
            box-shadow: var(--shadow-card);
            border: 1px solid rgba(0,0,0,0.02);
        }
        .date-picker-container { flex: 1; text-align: center; position: relative; }
        input[type="date"] { 
            border: none; background: transparent; 
            font-size: 16px; font-weight: 700; color: var(--text-primary); 
            text-align: center; width: 130px; cursor: pointer; font-family: inherit;
            outline: none;
        }
        .arrow-btn {
            background: var(--color-brand-light); border: none; width: 36px; height: 36px; border-radius: 50%;
            font-size: 18px; color: var(--color-brand); cursor: pointer;
            display: flex; align-items: center; justify-content: center; transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .arrow-btn:active { transform: scale(0.9); background: #d6eaf8; }

        /* æ˜ŸæœŸå°è¦½åˆ— */
        .nav-bar { display: flex; justify-content: space-between; gap: 6px; padding: 5px 2px 10px 2px; overflow-x: auto; scrollbar-width: none; }
        .nav-bar::-webkit-scrollbar { display: none; }
        .nav-btn {
            flex: 1; min-width: 44px;
            background: transparent; border: none; border-radius: 14px; padding: 10px 0;
            font-size: 13px; font-weight: 600; color: var(--text-secondary); 
            cursor: pointer; transition: all 0.3s ease;
            position: relative;
        }
        .nav-btn.active { 
            color: #fff; background: var(--color-brand);
            box-shadow: var(--shadow-float);
        }

        /* === å…§å®¹å€ === */
        #contentArea { padding: 10px 20px; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .empty-week { 
            text-align: center; padding: 60px 20px; color: var(--text-secondary); 
            font-weight: 500; font-size: 15px;
            display: flex; flex-direction: column; align-items: center; gap: 10px;
        }
        .empty-week::before { content: 'â˜•'; font-size: 40px; display: block; margin-bottom: 10px; opacity: 0.5; }

        /* === æˆ‘çš„ç­è¡¨å¡ç‰‡ === */
        .day-card { 
            background: var(--bg-card); border-radius: var(--radius-md); padding: 20px;
            margin-bottom: 20px; box-shadow: var(--shadow-card);
            position: relative; overflow: hidden;
            transition: transform 0.2s;
            scroll-margin-top: 180px;
            border: 1px solid rgba(0,0,0,0.03);
        }
        .day-card:active { transform: scale(0.99); }
        
        /* å·¦å´è£é£¾æ¢ */
        .day-card::before {
            content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 6px;
        }
        .day-card.work::before { background: var(--color-brand); }
        .day-card.rest::before { background: var(--color-rest); }
        .day-card.rest { opacity: 0.7; filter: grayscale(0.2); }
        
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
        .day-title { font-size: 20px; font-weight: 800; color: var(--text-primary); letter-spacing: -0.5px; }
        
        /* ç­æ¬¡æ¨™ç±¤ */
        .shift-badge {
            font-size: 13px; font-weight: 600; padding: 6px 14px; border-radius: 20px;
            display: flex; align-items: center; gap: 6px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .work .shift-badge { background-color: var(--color-brand-light); color: var(--color-brand); }
        .rest .shift-badge { background-color: #f2f3f4; color: var(--text-secondary); }
        
        /* è©³ç´°è³‡è¨Šè¡Œ */
        .detail-row {
            display: flex; justify-content: space-between; align-items: center;
            font-size: 15px; margin-top: 12px; padding-top: 12px;
            border-top: 1px dashed #eee;
        }
        .detail-row:first-of-type { border-top: none; margin-top: 0; padding-top: 0; }
        
        .loc-container { display: flex; align-items: center; font-weight: 600; color: var(--text-primary); }
        .loc-pin { 
            color: var(--color-danger); margin-right: 8px; font-size: 16px; 
            background: #fdeaea; padding: 4px; border-radius: 50%; width: 24px; height: 24px; 
            display: flex; align-items: center; justify-content: center;
        }
        .time { 
            font-family: "SF Mono", "Menlo", monospace; 
            color: var(--text-secondary); font-weight: 600; font-size: 14px;
            background: #f8f9fa; padding: 4px 8px; border-radius: 6px;
        }

        /* === åŒäº‹ç­è¡¨æ¨£å¼ === */
        .others-card {
            background: var(--bg-card); border-radius: var(--radius-md); overflow: hidden; margin-bottom: 24px;
            box-shadow: var(--shadow-card); scroll-margin-top: 180px; border: none;
        }
        .others-header {
            background: linear-gradient(to right, #f8f9fa, #fff); padding: 15px 20px; 
            border-bottom: 1px solid #eee;
            display: flex; justify-content: space-between; align-items: center;
        }
        .others-title { font-size: 18px; font-weight: 800; color: var(--text-primary); }

        .store-section { border-bottom: 1px solid #f0f0f0; }
        .store-section:last-child { border-bottom: none; }
        .store-title {
            padding: 12px 20px; font-size: 14px; font-weight: 700; color: var(--text-secondary);
            background: #fff; display: flex; align-items: center; letter-spacing: 0.5px;
        }
        .store-icon { margin-right: 8px; font-size: 16px; opacity: 0.8; }

        .staff-row {
            display: flex; justify-content: space-between; align-items: center;
            padding: 14px 20px; border-top: 1px solid #fafafa;
            transition: background 0.2s;
        }
        .staff-row:hover { background: #fdfdfd; }
        .staff-name { font-weight: 600; font-size: 15px; color: var(--text-primary); }
        
        /* æ”¯æ´æ¨™ç±¤æ¨£å¼å„ªåŒ– */
        .staff-loc-tag { 
            font-size: 10px; background: #fff0f0; color: var(--color-danger); 
            padding: 3px 8px; border-radius: 10px; margin-left: 8px; 
            font-weight: 700; border: 1px solid rgba(231, 76, 60, 0.1);
            vertical-align: middle;
        }
        .staff-time { 
            font-family: "SF Mono", monospace; font-size: 14px; 
            color: var(--color-brand); font-weight: 600; 
            background: var(--color-brand-light); padding: 2px 8px; border-radius: 4px;
        }
        .no-staff { padding: 20px; color: var(--text-secondary); font-size: 14px; text-align: center; background: #fafafa; }

        /* === åº•éƒ¨å°è¦½åˆ— (Floating) === */
        .bottom-nav {
            position: fixed; bottom: 20px; left: 20px; right: 20px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            display: flex; justify-content: space-around; padding: 12px; z-index: 200;
            border-radius: 24px; max-width: 460px; margin: 0 auto;
            border: 1px solid rgba(255,255,255,0.5);
        }
        .tab-btn {
            border: none; background: none; color: #b0b8bf; font-size: 11px; font-weight: 600;
            display: flex; flex-direction: column; align-items: center; cursor: pointer; width: 45%;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            padding: 4px 0; border-radius: 16px;
        }
        .tab-icon { font-size: 22px; margin-bottom: 4px; transition: transform 0.3s; }
        
        .tab-btn.active { color: var(--color-brand); background: var(--color-brand-light); }
        .tab-btn.active .tab-icon { transform: translateY(-2px); }
        
        .hidden { display: none; }
    </style>
</head>
<body>

<div class="container">
    <div class="sticky-header">
        <div class="header-controls">
            <button class="arrow-btn" onclick="changeWeek(-1)">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>
            </button>
            <div class="date-picker-container">
                <input type="date" id="datePicker" onchange="onDatePick()">
                <div style="font-size: 10px; color: #95a5a6; margin-top: 2px; font-weight: 500;">é»æ“Šé¸æ“‡æ—¥æœŸ</div>
            </div>
            <button class="arrow-btn" onclick="changeWeek(1)">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18l6-6-6-6"/></svg>
            </button>
        </div>
        <div class="nav-bar hidden" id="myNavBar"></div>
        <div class="nav-bar hidden" id="othersNavBar"></div>
    </div>

    <div id="contentArea"></div>
</div>

<div class="bottom-nav">
    <button class="tab-btn active" onclick="switchTab('my')" id="tab-my">
        <span class="tab-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
        </span>
        æˆ‘çš„ç­è¡¨
    </button>
    <button class="tab-btn" onclick="switchTab('others')" id="tab-others">
        <span class="tab-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M20 4H4v2h16V4zm1 10v-2l-1-5H4l-1 5v2h1v6h10v-6h4v6h2v-6h1zm-9 4H6v-4h6v4z"/></svg>
        </span>
        å„åº—æ’ç­
    </button>
</div>

<script>
    // ==========================================
    // 1. è³‡æ–™åº«å€åŸŸ
    // ==========================================
    
    // ã€æˆ‘çš„ç­è¡¨ã€‘(ç‹æ³“éŸ‹) - 12/8 ~ 12/14
    const MY_ROSTER = {
        "2025-12-08": [
            { id: 0, day: "é€±ä¸€", type: "work", name: "ç›Šæ°‘åˆ6", icon: "ğŸ ", list: [{loc:"ç›Šæ°‘åº—", t:"16:15-22:45"}] },
            { id: 1, day: "é€±äºŒ", type: "work", name: "ç›Šæ°‘åˆ6", icon: "ğŸ ", list: [{loc:"ç›Šæ°‘åº—", t:"16:15-22:45"}] },
            { id: 2, day: "é€±ä¸‰", type: "work", name: "æ™ºå–æ”¯æ´", icon: "âš ï¸", list: [
                {loc:"ç«‹é«˜æ™ºå–", t:"08:00-08:30"}, 
                {loc:"é”æ˜æ™ºå–", t:"08:30-09:30"}, 
                {loc:"é•·æ¦®æ™ºå–", t:"09:30-10:30"}
            ]},
            { id: 3, day: "é€±å››", type: "rest", name: "ä¼‘å‡", icon: "ğŸ’¤", list: [] },
            { id: 4, day: "é€±äº”", type: "work", name: "æ”¯æ´å¤§é‡Œ", icon: "âš ï¸", list: [{loc:"å¤§é‡Œåº—", t:"16:15-22:45"}] },
            { id: 5, day: "é€±å…­", type: "rest", name: "ä¼‘å‡", icon: "ğŸ’¤", list: [] },
            { id: 6, day: "é€±æ—¥", type: "rest", name: "ä¼‘å‡", icon: "ğŸ’¤", list: [] }
        ]
    };

    // ã€äº”åº—è©³ç´°ç­è¡¨ã€‘ - 12/8 ~ 12/14
    // é‚è¼¯ï¼šæ ¹æ“šåœ–ç‰‡é¡¯ç¤ºï¼Œå°‡äººå“¡åˆ†é…åˆ°ã€Œå¯¦éš›ä¸Šç­ã€çš„åº—é‹ªã€‚
    const OTHERS_ROSTER = {
        "2025-12-08": [
            {
                date: "12/8 (ä¸€)",
                stores: {
                    "ç›Šæ°‘åº—": [
                        {n:"é„­ç¿”ä»‹", t:"æ—©6"}, {n:"ç‹æ³“éŸ‹", t:"åˆ6"}, {n:"æ½˜æ˜•å²‘", t:"æ™š4"}, {n:"æ—å§¿æ¼©", t:"æ™š4"}
                    ],
                    "å¤§é‡Œåº—": [
                        {n:"æ—è‚²ç‘›", t:"æ—©8"}, {n:"å”ç¾…æ°", t:"åˆ6"}, {n:"ç™½æ²…å¹³", t:"æ™š4"}
                    ],
                    "æ±æ¦®åº—": [
                        {n:"é™³æŸå»·", t:"æ—©8"}, {n:"é‚±éƒç´˜", t:"åˆ6"}, {n:"åŠ‰å‰æ™", t:"æ™š4"}
                    ],
                    "é«˜å·¥åº—": [
                        {n:"æ›¾å®¶ç¹", t:"æ—©8"}, {n:"æ—ä¾ƒè¾°", t:"åˆ6"}, {n:"æ—å¨ç²½", t:"æ™š4"}
                    ],
                    "æ¨¹å¾·åº—": [
                        {n:"ç‹éŸ»æ™´", t:"æ—©8"}, {n:"å¾æŒ¯æ³°", t:"åˆ6"}, {n:"æ—ç´«æ¶µ", t:"æ™š4"}
                    ]
                }
            },
            {
                date: "12/9 (äºŒ)",
                stores: {
                    "ç›Šæ°‘åº—": [
                        {n:"ç‹èºè", t:"æ—©6"}, {n:"ç‹æ³“éŸ‹", t:"åˆ6"}, {n:"é‚±éƒç´˜", t:"æ™š4"}, {n:"æ—å§¿æ¼©", t:"æ™š6"}
                    ],
                    "å¤§é‡Œåº—": [
                        {n:"æ—ç¾½åº­", t:"æ—©8"}, {n:"å¾è‡£å®‡", t:"æ—©6"}, {n:"åŠ‰å‰æ™", t:"åˆ6"}, {n:"æ½˜æ˜•å²‘", t:"æ™š4"}
                    ],
                    "æ±æ¦®åº—": [
                        {n:"é™³æŸå»·", t:"æ—©6"}, {n:"æ–½å®£å‰", t:"åˆ6"}, {n:"æå¾‹è¡¡", t:"æ™š4"}
                    ],
                    "é«˜å·¥åº—": [
                        {n:"æ›¾å®¶ç¹", t:"æ—©8"}, {n:"ç™½æ²…å¹³", t:"åˆ6"}, {n:"æ–½è‚²ä¸", t:"æ™š4"}
                    ],
                    "æ¨¹å¾·åº—": [
                        {n:"ç‹éŸ»æ™´", t:"æ—©8"}, {n:"æ—ç´«æ¶µ", t:"åˆ6"}
                    ]
                }
            },
            {
                date: "12/10 (ä¸‰)",
                stores: {
                    "ç›Šæ°‘åº—": [
                        {n:"ç‹èºè", t:"æ—©6"}, {n:"æ–½è‚²ä¸", t:"åˆ6"}, {n:"å³æŸ”æ—‹", t:"æ™š4"}
                    ],
                    "å¤§é‡Œåº—": [
                        {n:"æ—ç¾½åº­", t:"æ—©8"}, {n:"å¾è‡£å®‡", t:"æ—©4"}, {n:"ç™½æ²…å¹³", t:"åˆ6"}, {n:"åŠ‰å‰æ™", t:"æ™š4"}
                    ],
                    "æ±æ¦®åº—": [
                        {n:"é„­ç¿”ä»‹", t:"æ—©4"}, {n:"æ—è‚²ç‘›", t:"åˆ4"}, {n:"å”ç¾…æ°", t:"åˆ6"}, {n:"æ–½å®£å‰", t:"æ™š4"}
                    ],
                    "é«˜å·¥åº—": [
                        {n:"æ›¾å®¶ç¹", t:"æ—©8"}, {n:"æ—ä¾ƒè¾°", t:"åˆ6"}, {n:"æ—å§¿æ¼©", t:"æ™š4"}, {n:"æ´ªäº¦è“", t:"æ™š4"}
                    ],
                    "æ¨¹å¾·åº—": [
                        {n:"ç‹éŸ»æ™´", t:"æ—©8"}, {n:"æ—ç´«æ¶µ", t:"åˆ6"}
                    ]
                }
            },
            {
                date: "12/11 (å››)",
                stores: {
                    "ç›Šæ°‘åº—": [
                        {n:"ç‹èºè", t:"æ—©6"}, {n:"æ½˜æ˜•å²‘", t:"åˆ6"}, {n:"é‚±éƒç´˜", t:"æ™š4"}
                    ],
                    "å¤§é‡Œåº—": [
                        {n:"æ—ç¾½åº­", t:"æ—©8"}, {n:"åŠ‰å‰æ™", t:"åˆ6"}, {n:"ç™½æ²…å¹³", t:"æ™š4"}
                    ],
                    "æ±æ¦®åº—": [
                        {n:"é™³æŸå»·", t:"æ—©6"}, {n:"å³æŸ”æ—‹", t:"åˆ6"}, {n:"æå¾‹è¡¡", t:"æ™š4"}
                    ],
                    "é«˜å·¥åº—": [
                        {n:"æ›¾å®¶ç¹", t:"æ—©8"}, {n:"æ¥Šä½³å‹", t:"åˆ6"}, {n:"æ–½è‚²ä¸", t:"æ™š4"}
                    ],
                    "æ¨¹å¾·åº—": [
                        {n:"æè‚²å˜‰", t:"æ—©8"}, {n:"æ—å¨ç²½", t:"åˆ6"}
                    ]
                }
            },
            {
                date: "12/12 (äº”)",
                stores: {
                    "ç›Šæ°‘åº—": [
                        {n:"ç‹èºè", t:"æ—©6"}, {n:"é‚±éƒç´˜", t:"åˆ6"}, {n:"æ–½è‚²ä¸", t:"æ™š4"}
                    ],
                    "å¤§é‡Œåº—": [
                        {n:"æ—ç¾½åº­", t:"æ—©8"}, {n:"å¾è‡£å®‡", t:"æ—©4"}, {n:"ç‹æ³“éŸ‹", t:"åˆ6"}, {n:"æ—å§¿æ¼©", t:"åˆ6"}, {n:"æ¥Šä½³å‹", t:"æ™š4"}
                    ],
                    "æ±æ¦®åº—": [
                        {n:"é™³æŸå»·", t:"æ—©8"}, {n:"å³æŸ”æ—‹", t:"åˆ6"}, {n:"æ–½å®£å‰", t:"æ™š4"}
                    ],
                    "é«˜å·¥åº—": [
                        {n:"æ›¾å®¶ç¹", t:"æ—©8"}, {n:"æ—ä¾ƒè¾°", t:"åˆ6"}, {n:"æ—å¨ç²½", t:"æ™š4"}
                    ],
                    "æ¨¹å¾·åº—": [
                        {n:"ç‹éŸ»æ™´", t:"æ—©8"}, {n:"å¾æŒ¯æ³°", t:"åˆ6"}, {n:"æ—ç´«æ¶µ", t:"æ™š4"}
                    ]
                }
            },
            {
                date: "12/13 (å…­)",
                stores: {
                    "ç›Šæ°‘åº—": [
                        {n:"æ—è‚²ç‘›", t:"æ—©8"}, {n:"æ½˜æ˜•å²‘", t:"åˆ6"}
                    ],
                    "å¤§é‡Œåº—": [
                        {n:"ç‹éŸ»æ™´", t:"æ—©8"}, {n:"æ¥Šä½³å‹", t:"åˆ6"}
                    ],
                    "æ±æ¦®åº—": [
                        {n:"é‚±éƒç´˜", t:"æ—©8"}, {n:"å³æŸ”æ—‹", t:"åˆ6"}
                    ],
                    "é«˜å·¥åº—": [
                        {n:"æ—ç¾½åº­", t:"æ—©8"}, {n:"å¾è‡£å®‡", t:"æ—©6"}, {n:"æ—å¨ç²½", t:"åˆ6"}
                    ],
                    "æ¨¹å¾·åº—": [
                        {n:"æè‚²å˜‰", t:"æ—©8"}, {n:"æ´ªéŠ˜æƒ ", t:"åˆ6"}
                    ]
                }
            },
            {
                date: "12/14 (æ—¥)",
                stores: {
                    "ç›Šæ°‘åº—": [
                        {n:"é„­ç¿”ä»‹", t:"æ—©4"}, {n:"æ½˜æ˜•å²‘", t:"åˆ8"}
                    ],
                    "å¤§é‡Œåº—": [
                        {n:"æ—è‚²ç‘›", t:"æ—©6"}, {n:"æ¥Šä½³å‹", t:"åˆ6"}
                    ],
                    "æ±æ¦®åº—": [
                        {n:"é™³æŸå»·", t:"æ—©6"}, {n:"æå¾‹è¡¡", t:"åˆ6"}
                    ],
                    "é«˜å·¥åº—": [
                        {n:"æ´ªéŠ˜æƒ ", t:"æ—©6"}, {n:"æ–½è‚²ä¸", t:"åˆ6"}
                    ],
                    "æ¨¹å¾·åº—": [
                        {n:"æ—ä¾ƒè¾°", t:"æ—©6"}, {n:"æ´ªäº¦è“", t:"åˆ6"}
                    ]
                }
            }
        ]
    };

    // ==========================================
    // 2. ç¨‹å¼é‚è¼¯
    // ==========================================
    function getMonday(d) {
        d = new Date(d);
        var day = d.getDay();
        var diff = d.getDate() - day + (day == 0 ? -6 : 1);
        return new Date(d.setDate(diff));
    }
    function formatDateISO(d) {
        let y = d.getFullYear();
        let m = String(d.getMonth() + 1).padStart(2, '0');
        let day = String(d.getDate()).padStart(2, '0');
        return `${y}-${m}-${day}`;
    }

    // å°‡é è¨­æ—¥æœŸè¨­å®šç‚º 2025-12-08
    let currentMonday = getMonday(new Date("2025-12-08"));
    let currentTab = 'my'; 

    // åˆå§‹åŒ–
    renderPage();

    function switchTab(tabName) {
        currentTab = tabName;
        document.getElementById('tab-my').className = tabName === 'my' ? 'tab-btn active' : 'tab-btn';
        document.getElementById('tab-others').className = tabName === 'others' ? 'tab-btn active' : 'tab-btn';
        renderPage();
    }

    function changeWeek(offset) {
        currentMonday.setDate(currentMonday.getDate() + (offset * 7));
        renderPage();
    }
    
    function onDatePick() {
        const picker = document.getElementById("datePicker");
        if(picker.value) {
            currentMonday = getMonday(new Date(picker.value));
            renderPage();
        }
    }

    function renderPage() {
        let dateKey = formatDateISO(currentMonday);
        document.getElementById("datePicker").value = dateKey;

        const contentDiv = document.getElementById("contentArea");
        const myNav = document.getElementById("myNavBar");
        const othersNav = document.getElementById("othersNavBar");
        
        contentDiv.innerHTML = "";

        if (currentTab === 'my') {
            myNav.classList.remove("hidden");
            othersNav.classList.add("hidden");
            renderMySchedule(dateKey, contentDiv, myNav);
        } else {
            myNav.classList.add("hidden");
            othersNav.classList.remove("hidden");
            renderOthersSchedule(dateKey, contentDiv, othersNav);
        }
    }

    // æ¸²æŸ“ï¼šæˆ‘çš„ç­è¡¨
    function renderMySchedule(dateKey, listDiv, navDiv) {
        const weekData = MY_ROSTER[dateKey];
        navDiv.innerHTML = "";

        if (!weekData) {
            listDiv.innerHTML = `<div class="empty-week">ğŸ“… æœ¬é€±å°šç„¡æ‚¨çš„ç­è¡¨</div>`;
            return;
        }

        weekData.forEach((item, index) => {
            let btn = document.createElement("button");
            btn.className = "nav-btn";
            btn.innerText = item.day.replace("é€±","");
            btn.onclick = () => scrollToId(`card-${index}`, index, 'my');
            btn.id = `my-btn-${index}`;
            navDiv.appendChild(btn);

            let html = `
                <div class="day-card ${item.type}" id="card-${index}">
                    <div class="card-header">
                        <span class="day-title">${item.day}</span>
                        <span class="shift-badge">
                            <span class="badge-icon">${item.icon || ''}</span>
                            ${item.name}
                        </span>
                    </div>
            `;
            if(item.list.length > 0) {
                item.list.forEach(sub => {
                    html += `
                        <div class="detail-row">
                            <span class="loc-container">
                                <span class="loc-pin">ğŸ“</span>
                                ${sub.loc}
                            </span>
                            <span class="time">${sub.t}</span>
                        </div>`;
                });
            } else {
                 html += `
                        <div class="detail-row" style="color:#bdc3c7; justify-content:center; border:none;">
                            å¥½å¥½ä¼‘æ¯ï¼Œå……é›»å†å‡ºç™¼ï¼
                        </div>`;
            }
            html += `</div>`;
            listDiv.innerHTML += html;
        });
        
        autoHighlightDay('my');
    }

    // æ¸²æŸ“ï¼šäº”åº—ç­è¡¨
    function renderOthersSchedule(dateKey, listDiv, navDiv) {
        const weekData = OTHERS_ROSTER[dateKey];
        navDiv.innerHTML = "";

        if (!weekData) {
            listDiv.innerHTML = `<div class="empty-week">ğŸ‘¥ æœ¬é€±å°šæœªè¨˜éŒ„åŒäº‹ç­è¡¨</div>`;
            return;
        }

        const days = ["ä¸€", "äºŒ", "ä¸‰", "å››", "äº”", "å…­", "æ—¥"];
        
        weekData.forEach((dayInfo, index) => {
            let btn = document.createElement("button");
            btn.className = "nav-btn";
            btn.innerText = days[index];
            btn.onclick = () => scrollToId(`others-${index}`, index, 'others');
            btn.id = `others-btn-${index}`;
            navDiv.appendChild(btn);

            let html = `
                <div class="others-card" id="others-${index}">
                    <div class="others-header">
                        <span class="others-title">${dayInfo.date.split(' ')[0]} é€±${days[index]}</span>
                    </div>
            `;

            const storeOrder = ["ç›Šæ°‘åº—", "å¤§é‡Œåº—", "æ±æ¦®åº—", "é«˜å·¥åº—", "æ¨¹å¾·åº—"];
            
            storeOrder.forEach(storeName => {
                let staffs = dayInfo.stores[storeName];
                html += `<div class="store-section">
                            <div class="store-title">
                                <span class="store-icon">ğŸ¢</span>${storeName}
                            </div>`;
                
                if(staffs && staffs.length > 0) {
                    staffs.forEach(p => {
                        html += `
                            <div class="staff-row">
                                <div>
                                    <span class="staff-name">${p.n}</span>
                                    ${p.t.includes('(') ? `<span class="staff-loc-tag">${p.t.split('(')[1].replace(')','')}</span>` : ''}
                                </div>
                                <span class="staff-time">${p.t.split(' ')[0]}</span>
                            </div>
                        `;
                    });
                } else {
                    html += `<div class="no-staff">ç„¡æ’ç­äººå“¡</div>`;
                }
                html += `</div>`;
            });

            html += `</div>`;
            listDiv.innerHTML += html;
        });

        autoHighlightDay('others');
    }

    function scrollToId(elementId, index, prefix) {
        document.querySelectorAll(`#${prefix}NavBar .nav-btn`).forEach(b => b.classList.remove('active'));
        let btn = document.getElementById(`${prefix}-btn-${index}`);
        if(btn) btn.classList.add('active');
        
        const el = document.getElementById(elementId);
        if(el) el.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    function autoHighlightDay(prefix) {
        let today = new Date();
        let diffTime = today - currentMonday;
        let diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
        
        let targetIdx = 0; // default Monday
        if (diffDays >= 0 && diffDays <= 6) {
            let todayIdx = today.getDay() - 1;
            if (todayIdx < 0) todayIdx = 6;
            targetIdx = todayIdx;
        }
        
        setTimeout(() => {
            let btn = document.getElementById(`${prefix}-btn-${targetIdx}`);
            if(btn) btn.classList.add('active');
        }, 50);
    }
</script>
</body>
</html>
